# 独立 Win32 应用的许可

## 如何授予文件访问许可

独立 Win32 应用有三种方式授予许可。

1. 隐式许可：应用程序通过以下流程隐式地访问文件和文件夹。

    * 文件对话框：通过独立应用程序创建的 Windows 文件对话框选择或创建的文件和文件夹。

    * 文件类型关联：在清单中注册 FTA 的应用程序将显示在“打开方式”上下文菜单下，并可设置为默认应用程序。
        * 通过 COM 扩展进行此操作的应用程序将需要 `isolatedWin32-shellExtensionContextMenu` 功能。

    * 拖放：注册拖放处理程序的应用程序将访问拖放到它们上的任何文件和文件夹。
        * 目前不支持在不同的独立 Win32 应用程序之间拖放。

2. 发布者目录：如果应用程序具有 `isolatedWin32-accessToPublisherDirectory` 功能，则该应用程序将完全访问：

    * 共享名称以应用程序发布者 ID 结尾的网络共享。

    * 以应用程序发布者 ID 结尾的名称位于 `\Device\BootDevice\ProgramData` 中的目录。

3. 提示：如果应用程序具有 `isolatedWin32-promptForAccess` 功能，则第一次尝试访问文件或目录时，将生成提示供用户接受或拒绝。选择将保存，直到撤销许可为止。

## 如何撤销许可

目前有两种方法可以撤销许可。

1. 设置：通过设置，导航到“重置独立 Win32 应用程序上的文件权限”。在此页面上，您可以完全重置授予特定独立应用程序的许可。这将重置提示和隐式许可，但不会影响发布者目录。

2. 卸载：在卸载期间，将撤销所有许可。
